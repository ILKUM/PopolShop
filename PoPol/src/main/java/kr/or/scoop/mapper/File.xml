<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.scoop.dao.BoardDao">
	<select id="getFileBoard" resultType="kr.or.scoop.dto.File">	
	select m.name, f.fseq , f.ftitle, f.ftime , f.flike, f.frnum,f.fdnum from member m join fileboard f on m.email = f.email
	</select>
	<insert id="insertFile" parameterType="kr.or.scoop.dto.File">
	insert into FILEBOARD (fseq,ftitle,fcontent,filename,email,flike,frnum,fdnum,ftime)
  		values (FSEQ_FILEBOARD_SEQ.NEXTVAL, #{ftitle,jdbcType=VARCHAR}, #{fcontent,jdbcType=VARCHAR}, #{filename,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR},#{flike,jdbcType=INTEGER},#{frnum,jdbcType=INTEGER},#{fdnum,jdbcType=INTEGER},SYSDATE)
	</insert>
	<update id="minusPoint">
	 update member set point = point - 500 where email = #{email}
	</update>
	<delete id="deleteFile">
		delete from FILEBOARD where fseq = #{fseq}
	</delete>
	<select id="detailFile" resultType="kr.or.scoop.dto.File">
		select m.name, f.fseq,f.email , f.ftitle, f.ftime , f.flike, f.frnum,f.fdnum,f.filename from member m join fileboard f on m.email = f.email where f.fseq = #{fseq}
	</select>
	<select id="checkFile" resultType="int">
		select count(*) from filemem where fseq = #{param1} and email = #{param2}
	</select>
	<insert id="insertFlike" parameterType="kr.or.scoop.dto.File">
		insert into FILEMEM(fmseq,fseq,email) 
		values (FMSEQ_FILEMEM_SEQ.NEXTVAL,#{param1},#{param2})
	</insert>
	<update id="flikeUp" parameterType="kr.or.scoop.dto.File">
		update Fileboard set flike = flike+1 where fseq = #{fseq}
	</update>
	<update id="readFile">
		update Fileboard set frnum = frnum+1 where fseq = #{fseq}
	</update>
	<!-- 내가 작성한 파일 글 -->
	<select id="getWriteFile" resultType="kr.or.scoop.dto.File">
	 select * from member m join fileboard f on m.email = f.email where m.email = #{email}
	</select>
	<!-- 파일글 덧글 등록 -->
	<insert id="fileComment" parameterType="kr.or.scoop.dto.FileReply">
	insert into fREPLY(frseq, fseq, email , frcontent , frtime)
  	values(FRSEQ_FREPLY_SEQ.NEXTVAL , #{param1}, #{param2}, #{param3} , sysdate)
	</insert>
	<!-- 추천글 덧글 리스트 출력  -->
	<select id="fileCommentOk" resultType="kr.or.scoop.dto.FileReply">
	select * from freply f join member m on f.email=m.email where f.fseq = #{fseq}
	</select>
</mapper>